"use strict";

var chai = require('chai');
var sinon = require('sinon');
var expect = chai.expect;
var opCodeParser = require('./../../utils/opCodeParser');

describe('opCodeParser', function () {
  before(function () {
    console.log('starting');
  });

  after(function () {
    console.log('finished');
  });


  it('parse() handles long input correctly', function () {
    var opCodes = '0x6060604052361561001f5760e060020a600035046372ea4b8c811461010c575b61011b3460008080678ac7230489e8000084106101d557600180548101908190556003805433929081101561000257906000526020600020900160006101000a815481600160a060020a0302191690830217905550678ac7230489e80000840393508350678ac7230489e800006000600082828250540192505081905550600260016000505411151561011d5760038054829081101561000257906000526020600020900160009054906101000a9004600160a060020a0316600160a060020a03166000600060005054604051809050600060405180830381858888f150505080555060016002556101d5565b60018054016060908152602090f35b005b60018054600354910114156101d55760038054600254600101909102900392505b6003546002549003600119018310156101e357600380548490811015610002579082526040517fc2575a0e9e593c00f959f8c92f12db2869c3395a3b0502d05e2516446f71f85b9190910154600160a060020a0316908290674563918244f400009082818181858883f150509054674563918244f3ffff1901835550506001929092019161013e565b505060028054600101905550505b600080548501905550505050565b506002548154919250600190810190910460001901905b60035460025490036001190183101561029a576003805484908110156100025760009182526040517fc2575a0e9e593c00f959f8c92f12db2869c3395a3b0502d05e2516446f71f85b9190910154600160a060020a03169190838504600019019082818181858883f1505081548486049003600190810190925550600290830183020460001901841415905061028e576001015b600192909201916101fa565b60038054600254810182018083559190829080158290116101c75760008390526101c7907fc2575a0e9e593c00f959f8c92f12db2869c3395a3b0502d05e2516446f71f85b9081019083015b808211156102fa57600081556001016102e6565b509056';
    var parsedOpCodes = 'PUSH1	0x60PUSH1	0x40MSTORECALLDATASIZEISZEROPUSH2	0x001fJUMPIPUSH1	0xe0PUSH1	0x02EXPPUSH1	0x00CALLDATALOADDIVPUSH4	0x72ea4b8cDUP2EQPUSH2	0x010cJUMPIJUMPDESTPUSH2	0x011bCALLVALUEPUSH1	0x00DUP1DUP1PUSH8	0x8ac7230489e80000DUP5LTPUSH2	0x01d5JUMPIPUSH1	0x01DUP1SLOADDUP2ADDSWAP1DUP2SWAP1SSTOREPUSH1	0x03DUP1SLOADCALLERSWAP3SWAP1DUP2LTISZEROPUSH2	0x0002JUMPISWAP1PUSH1	0x00MSTOREPUSH1	0x20PUSH1	0x00SHA3SWAP1ADDPUSH1	0x00PUSH2	0x0100EXPDUP2SLOADDUP2PUSH1	0x01PUSH1	0xa0PUSH1	0x02EXPMULSUBNOTANDSWAP1DUP4SUBORSWAP1SSTOREPOPPUSH8	0x8ac7230489e80000DUP5MULSWAP4POPDUP4POPPUSH8	0x8ac7230489e80000PUSH1	0x00PUSH1	0x00DUP3DUP3DUP3POPSLOADADDSWAP3POPPOPDUP2SWAP1SSTOREPOPPUSH1	0x02PUSH1	0x01PUSH1	0x00POPSLOADGTISZEROISZEROPUSH2	0x011dJUMPIPUSH1	0x03DUP1SLOADDUP3SWAP1DUP2LTISZEROPUSH2	0x0002JUMPISWAP1PUSH1	0x00MSTOREPUSH1	0x20PUSH1	0x00SHA3SWAP1ADDPUSH1	0x00SWAP1SLOADSWAP1PUSH2	0x0100EXPSWAP1DIVPUSH1	0x01PUSH1	0xa0PUSH1	0x02EXPMULANDPUSH1	0x01PUSH1	0xa0PUSH1	0x02EXPMULANDPUSH1	0x00PUSH1	0x00PUSH1	0x00POPSLOADPUSH1	0x40MLOADDUP1SWAP1POPPUSH1	0x00PUSH1	0x40MLOADDUP1DUP4MULDUP2DUP6DUP9DUP9CALLPOPPOPPOPDUP1SSTOREPOPPUSH1	0x01PUSH1	0x02SSTOREPUSH2	0x01d5JUMPJUMPDESTPUSH1	0x01DUP1SLOADADDPUSH1	0x60SWAP1DUP2MSTOREPUSH1	0x20SWAP1RETURNJUMPDESTSTOPJUMPDESTPUSH1	0x01DUP1SLOADPUSH1	0x03SLOADSWAP2ADDEQISZEROPUSH2	0x01d5JUMPIPUSH1	0x03DUP1SLOADPUSH1	0x02SLOADPUSH1	0x01ADDSWAP1SWAP2SUBSWAP1MULSWAP3POPJUMPDESTPUSH1	0x03SLOADPUSH1	0x02SLOADSWAP1MULPUSH1	0x01NOTADDDUP4LTISZEROPUSH2	0x01e3JUMPIPUSH1	0x03DUP1SLOADDUP5SWAP1DUP2LTISZEROPUSH2	0x0002JUMPISWAP1DUP3MSTOREPUSH1	0x40MLOADPUSH32	0xc2575a0e9e593c00f959f8c92f12db2869c3395a3b0502d05e2516446f71f85bSWAP2SWAP1SWAP2ADDSLOADPUSH1	0x01PUSH1	0xa0PUSH1	0x02EXPMULANDSWAP1DUP3SWAP1PUSH8	0x4563918244f40000SWAP1DUP3DUP2DUP2DUP2DUP6DUP9DUP4CALLPOPPOPSWAP1SLOADPUSH8	0x4563918244f3ffffNOTADDDUP4SSTOREPOPPOPPUSH1	0x01SWAP3SWAP1SWAP3ADDSWAP2PUSH2	0x013eJUMPJUMPDESTPOPPOPPUSH1	0x02DUP1SLOADPUSH1	0x01ADDSWAP1SSTOREPOPPOPJUMPDESTPUSH1	0x00DUP1SLOADDUP6ADDSWAP1SSTOREPOPPOPPOPPOPJUMPJUMPDESTPOPPUSH1	0x02SLOADDUP2SLOADSWAP2SWAP3POPPUSH1	0x01SWAP1DUP2ADDSWAP1SWAP2DIVPUSH1	0x00NOTADDSWAP1JUMPDESTPUSH1	0x03SLOADPUSH1	0x02SLOADSWAP1MULPUSH1	0x01NOTADDDUP4LTISZEROPUSH2	0x029aJUMPIPUSH1	0x03DUP1SLOADDUP5SWAP1DUP2LTISZEROPUSH2	0x0002JUMPIPUSH1	0x00SWAP2DUP3MSTOREPUSH1	0x40MLOADPUSH32	0xc2575a0e9e593c00f959f8c92f12db2869c3395a3b0502d05e2516446f71f85bSWAP2SWAP1SWAP2ADDSLOADPUSH1	0x01PUSH1	0xa0PUSH1	0x02EXPMULANDSWAP2SWAP1DUP4DUP6DIVPUSH1	0x00NOTADDSWAP1DUP3DUP2DUP2DUP2DUP6DUP9DUP4CALLPOPPOPDUP2SLOADDUP5DUP7DIVSWAP1MULPUSH1	0x01SWAP1DUP2ADDSWAP1SWAP3SSTOREPOPPUSH1	0x02SWAP1DUP4ADDDUP4SUBDIVPUSH1	0x00NOTADDDUP5EQISZEROSWAP1POPPUSH2	0x028eJUMPIPUSH1	0x01ADDJUMPDESTPUSH1	0x01SWAP3SWAP1SWAP3ADDSWAP2PUSH2	0x01faJUMPJUMPDESTPUSH1	0x03DUP1SLOADPUSH1	0x02SLOADDUP2ADDDUP3ADDDUP1DUP4SSTORESWAP2SWAP1DUP3SWAP1DUP1ISZERODUP3SWAP1GTPUSH2	0x01c7JUMPIPUSH1	0x00DUP4SWAP1MSTOREPUSH2	0x01c7SWAP1PUSH32	0xc2575a0e9e593c00f959f8c92f12db2869c3395a3b0502d05e2516446f71f85bSWAP1DUP2ADDSWAP1DUP4ADDJUMPDESTDUP1DUP3GTISZEROPUSH2	0x02faJUMPIPUSH1	0x00DUP2SSTOREPUSH1	0x01ADDPUSH2	0x02e6JUMPJUMPDESTPOPSWAP1JUMP';

    var parsed = opCodeParser.parse(opCodes);

    expect(parsed).to.eql(parsedOpCodes);
  });
});